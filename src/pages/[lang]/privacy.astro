---
import Layout from '../../layouts/Layout.astro';
import LoadingScreen from '../../components/LoadingScreen.astro';

export const prerender = true;

export async function getStaticPaths() {
  return [
    { params: { lang: 'en' } },
    { params: { lang: 'es' } }
  ];
}

const { lang = 'en' } = Astro.params;

let PP;
try {
  PP = (await import(`../../content/${lang}/privacy-policy.md`)).default;
} catch {
  PP = (await import(`../../content/en/privacy-policy.md`)).default;
}

// SEO Data
const seoTitle = lang === 'es' 
  ? 'Política de Privacidad - OSIX Tech'
  : 'Privacy Policy - OSIX Tech';

const seoDescription = lang === 'es'
  ? 'Política de privacidad de OSIX Tech. Información sobre cómo recopilamos, usamos y protegemos tus datos personales.'
  : 'OSIX Tech Privacy Policy. Information about how we collect, use and protect your personal data.';

// Structured Data
const breadcrumbSchema = {
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": `https://osix.tech/${lang}/`
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": lang === 'es' ? 'Política de Privacidad' : 'Privacy Policy',
      "item": `https://osix.tech/${lang}/privacy`
    }
  ]
};

const webPageSchema = {
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": seoTitle,
  "description": seoDescription,
  "url": `https://osix.tech/${lang}/privacy`,
  "inLanguage": lang,
  "isPartOf": {
    "@type": "WebSite",
    "name": "OSIX Tech",
    "url": "https://osix.tech"
  },
  "breadcrumb": breadcrumbSchema
};

const jsonLd = [webPageSchema];

---

<Layout 
  lang={lang as 'en' | 'es'}
  title={seoTitle}
  description={seoDescription}
  pageType="article"
  jsonLd={jsonLd}>
  <LoadingScreen duration={1000} />
  
  <!-- Hero Section -->
  <section class="hero-section relative min-h-[400px] bg-black lg:min-h-[450px] flex items-center overflow-hidden mb-0" style="margin-top: var(--header-h, 0px)">
    <div class="flex justify-center mx-auto max-w-7xl z-10 px-4 sm:px-6 lg:px-0 w-full">
      <div class="flex-col flex justify-center items-center max-w-3xl">
        <h1 class="hero-title text-center text-5xl md:text-7xl font-bold text-white mb-4 opacity-0">
          {lang === 'es' ? 'Política de Privacidad' : 'Privacy Policy'}
        </h1>
        <p class="hero-subtitle text-xl text-center md:text-2xl text-gray-300 mb-6 opacity-0">
          {lang === 'es'
            ? 'Información sobre cómo OSIX Tech recopila, usa y protege tus datos personales'
            : 'Information about how OSIX Tech collects, uses and protects your personal data'
          }
        </p>
      </div>
    </div>
  </section>

  <!-- Content Section -->
  <section class="content-section pt-16 pb-32 bg-white mb-0">
    <div class="max-w-6xl mx-auto px-6 md:px-12">
      <div class="content-card bg-white rounded-lg p-8 md:p-12 fade-up" style="--delay: 0.2s">
        <div class="markdown-body">
          <PP />
        </div>
      </div>

      <!-- Back to home button -->
      <div class="text-center mt-12 fade-up" style="--delay: 0.4s">
        <a href={`/${lang}/`} class="btn-primary btn-arrow">
          {lang === 'es' ? 'Volver al inicio' : 'Back to home'}
          <svg class="btn-arrow-icon" width="14" height="14" viewBox="0 0 16 16" fill="none"><path d="M3 8h10M9 4l4 4-4 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </a>
      </div>
    </div>
  </section>
</Layout>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    // Fix navigation links to properly redirect to main page sections
    setTimeout(() => {
      const navLinks = document.querySelectorAll('.nav-item[href*="#"]');
      navLinks.forEach(link => {
        const href = link.getAttribute('href');
        if (href && href.includes('#')) {
          link.removeEventListener('click', () => {});
          link.addEventListener('click', (e) => {
            e.preventDefault();
            window.location.href = href;
          });
        }
      });
      
      // Fix contact button
      const contactBtn = document.querySelector('.contact-btn');
      if (contactBtn) {
        const href = contactBtn.getAttribute('href');
        if (href) {
          contactBtn.removeEventListener('click', () => {});
          contactBtn.addEventListener('click', (e) => {
            e.preventDefault();
            window.location.href = href;
          });
        }
      }
    }, 500);
    
    const initializeAnimations = () => {
      // Hero animations – staggered on page load
      setTimeout(() => { document.querySelector('.hero-title')?.classList.add('animate'); }, 400);
      setTimeout(() => { document.querySelector('.hero-subtitle')?.classList.add('animate'); }, 600);

      // Content fade-ups – immediately
      document.querySelectorAll('.fade-up').forEach(el => {
        el.classList.add('in-view');
      });
    };

    // Wait for loading screen to complete
    if ((window as any).isLoadingComplete) {
      initializeAnimations();
    } else {
      window.addEventListener('loadingComplete', initializeAnimations);
    }
  });
</script>

<style>
  /* Hero Animations */
  .hero-title { opacity: 0; transform: translateX(-100px) skewX(-5deg); transition: all 0.8s cubic-bezier(0.19, 1, 0.22, 1); }
  .hero-title.animate { opacity: 1; transform: translateX(0) skewX(0); }
  .hero-subtitle { opacity: 0; transform: translateX(100px); transition: all 0.7s cubic-bezier(0.19, 1, 0.22, 1); }
  .hero-subtitle.animate { opacity: 1; transform: translateX(0); }

  /* Fade up animation */
  .fade-up {
    opacity: 0;
    transform: translateY(40px);
    transition: all 0.8s cubic-bezier(0.16, 1, 0.3, 1);
    transition-delay: var(--delay, 0s);
  }
  
  .fade-up.in-view {
    opacity: 1;
    transform: translateY(0);
  }
  
  /* Section transitions */
  .hero-section { animation: heroReveal 1s cubic-bezier(0.22, 1, 0.36, 1); }
  @keyframes heroReveal { from { opacity: 0; } to { opacity: 1; } }
  
</style>